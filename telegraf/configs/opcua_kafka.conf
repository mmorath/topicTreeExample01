[global_tags]
[agent]
  #interval = "500ms"
  interval = "1s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "10s"
  flush_jitter = "0s"
  precision = "0s"
  hostname = ""
  omit_hostname = false
###############################################################################
#                            OUTPUT PLUGINS                                   #
###############################################################################
[outputs.kafka]
    # URLs of kafka brokers
    brokers = ["kafka:9092"] # EDIT THIS LINE
    # Kafka topic for producer messages
    topic = "pfc200"  
    version = "1.1.0"
    client_id= "pfc200"
    data_format ="json"
###############################################################################
#                            AGGREGATOR PLUGINS                               #
###############################################################################

###############################################################################
#                            INPUT PLUGINS                                    #
###############################################################################
# Retrieve data from OPCUA devices
[[inputs.opcua]]
  name = "pfc200"
  endpoint = "opc.tcp://192.168.178.97:4840"
  connect_timeout = "10s"
  request_timeout = "5s"
  security_policy = "None"
  security_mode = "None"
  auth_method = "UserName"
  username = "admin"
  password = "wago"

  [[inputs.opcua.group]]
    name="iiot_box_alive"
    namespace ="4"
    identifier_type ="s"
    #example for tags....fake...
    tags=[["division","EMT"],
          ["site","LHB"],
          ["building","Halle_03"],
          ["department","3H34"],
          ["machine","Pama156"],
          ]
    nodes = [
      {name="xHeartbeat", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_STATUS_PRG.IIoTgateway_xHeartbeat"},
    ]

  [[inputs.opcua.group]]
    name="iiot_box_ouputs"
    namespace ="4"
    identifier_type ="s"
    tags=[["division","EMT"],
          ["site","LHB"],
          ["building","Halle_03"],
          ["department","3H34"],
          ["machine","Pama156"],
          ]   
    nodes = [  
      {name="xPushButtonIndicatorB", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xPushButtonIndicatorB"},
      {name="xPushButtonIndicatorG", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xPushButtonIndicatorG"},
      {name="xPushButtonIndicatorR", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xPushButtonIndicatorR"},
      {name="xSignalLampBuzzer", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xSignalLampBuzzer"},
      {name="xSignalLampSegment01", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xSignalLampSegment01"},
      {name="xSignalLampSegment02", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xSignalLampSegment02"},
      {name="xSignalLampSegment03", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xSignalLampSegment03"},
      {name="xSignalLampSegment04", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_OUTPUTS.IIoTgateway_xSignalLampSegment04"},
    ]

  [[inputs.opcua.group]]
    name="iiot_box_inputs"
    namespace ="4"
    identifier_type ="s"
    tags=[["division","EMT"],
          ["site","LHB"],
          ["building","Halle_03"],
          ["department","3H34"],
          ["machine","Pama156"],    
          ]      
    nodes = [ 
      {name="xDoorSwitch", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xDoorSwitch"},
      {name="xEmergencyStop", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xEmergencyStop"},
      {name="xKeyLockPos1", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xKeyLockPos1"},
      {name="xKeyLockPos2", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xKeyLockPos2"},
      {name="xPowerSupply24VOK", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xPowerSupply24VOK"},
      {name="xPowerSupply48VOK", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xPowerSupply48VOK"},
      {name="xServiceButton", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xServiceButton"},
      {name="xVoltagePresent", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xVoltagePresent"},
    ]

  [[inputs.opcua.group]]
    name="mde_signals"
    namespace ="4"
    identifier_type ="s"
    tags=[["division","EMT"],
          ["site","LHB"],
          ["building","Halle_03"],
          ["department","3H34"],
          ["machine","Pama156"],    
          ]  
    nodes = [ 
      {name="xAutomaticSwitchOff", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xAutomaticSwitchOff"},
      {name="xMainCircuitSwitchOn", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xMainCircuitSwitchOn"},
      {name="xProgramStop", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xProgramStop"},
      {name="xLaserActive", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xLaserActive"},
      {name="xImpulse", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xImpulse"},
      {name="xSumError", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xSumError"},
      {name="xProductionTime", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xProductionTime"},
      {name="xTargetCountReached", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_IIOT_BOX_INPUTS.IIoTgateway_xTargetCountReached"},
    ]

  [[inputs.opcua.group]]
    name="plc_stats"
    namespace ="4"
    identifier_type ="s"
    tags=[["division","EMT"],
          ["site","LHB"],
          ["building","Halle_03"],
          ["department","3H34"],
          ["machine","Pama156"],    
          ]  
    nodes = [     
      {name="sActualHostName", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sActualHostName"},
      {name="sDateLocal", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sDateLocal"},
      {name="sDisplayMode", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sDisplayMode"},
      {name="sDomainName", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sDomainName"},
      {name="sFirmwareRevision", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sFirmwareRevision"},
      {name="sHostName", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sHostName"},
      {name="sIpAddress_X1", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sIpAddress_X1"},
      {name="sIpAddress_X2", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sIpAddress_X2"},
      {name="sLicenseInformation", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sLicenseInformation"},
      {name="sMacAddress_X1", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sMacAddress_X1"},
      {name="sMacAddress_X2", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sMacAddress_X2"},
      {name="sOrderNumber", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sOrderNumber"},
      {name="sProductDescription", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sProductDescription"},
      {name="sSubNetMask_X1", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sSubNetMask_X1"},
      {name="sSubNetMask_X2", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sSubNetMask_X2"},
      {name="sTimeLocal", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sTimeLocal"},
      {name="sTimeUtc", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_sTimeUtc"},
      {name="xEnable_X1x", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_xEnable_X1"},
      {name="xEnable_X2", namespace="4", identifier_type="s", identifier="|var|WAGO 750-8212 PFC200 G2 2ETH RS.Application.GVL_INFO_PRG.IIoTgateway_xEnable_X2"},
    ]
 
  [[outputs.file]]
  ## Files to parse each interval.  Accept standard unix glob matching rules,
  ## as well as ** to match recursive files and directories.
    files = ["./tmp/metrics.out"]
    data_format = "influx"
    rotation_interval = "24h"
    rotation_max_archives = 10